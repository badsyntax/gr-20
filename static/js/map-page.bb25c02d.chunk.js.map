{"version":3,"sources":["util/constants.ts","util/util.ts","components/GpxLayer/GpxSource.tsx","components/GpxLayer/baseline-location_on-24px-yellow.svg","components/GpxLayer/GpxLayerStyles.ts","components/GpxLayer/GpxLayer.tsx","components/GpxLayer/selected-pin.png","components/ControlButtons/DownloadControlButton/DownloadControlButton.tsx","components/ControlButtons/ControlButton/ControlButton.tsx","components/ControlButtons/MyLocationControlButton/baseline-my_location-24px-yellow.svg","components/ControlButtons/MyLocationControlButton/MyLocationControlButton.tsx","components/ControlButtons/PdfExportControlButton/PdfExportControlButton.tsx","components/ControlButtons/ZoomToExtentControlButton/ZoomToExtentControlButton.tsx","components/ControlButtons/ZoomInControlButton/ZoomInControlButton.tsx","components/ControlButtons/ZoomOutControlButton/ZoomOutControlButton.tsx","components/Settings/Settings.styles.ts","components/Settings/Settings.tsx","components/ControlButtons/SettingsToggleControlButton/SettingsToggleControlButton.styles.ts","components/ControlButtons/SettingsToggleControlButton/SettingsToggleControlButton.tsx","components/MapControls/styles.ts","components/MapControls/MapControls.tsx","components/TileLayer/TileLayer.tsx","components/Map/styles.ts","components/PointData/PointData.tsx","components/ControlButtons/NextPointControlButton/NextPointControlButton.tsx","components/ControlButtons/PrevPointControlButton/PrevPointControlButton.tsx","components/ControlButtons/ZoomToPointControlButton/ZoomToPointControlButton.tsx","components/ControlButtons/Google360ControlButton/360-24px.svg","components/ControlButtons/Google360ControlButton/Google360ControlButton.tsx","components/WaypointControlButtons/WaypointControlButtons.styles.ts","components/WaypointControlButtons/WaypointControlButtons.tsx","components/TabPanel/TabPanel.tsx","components/NextPointData/NextPointData.tsx","components/WaypointDrawer/WaypointDrawerTabs.tsx","components/WaypointDrawer/WaypointDrawer.styles.ts","components/WaypointDrawer/WaypointDrawer.tsx","components/StartFinishLayer/util.ts","components/StartFinishLayer/StartFinishLayer.tsx","components/Map/Map.tsx","components/MapPage/styles.ts","components/MapPage/MapPage.tsx"],"names":["PDFDims","a0","a1","a2","a3","a4","a5","START_POINT_ID","FINISH_POINT_ID","START_POINT_LABEL","FINISH_POINT_LABEL","MULTI_LINE_STRING","GeometryType","POINT","getElevation","coordinate","Math","round","getDataFromCoords","coords","lonLat","toLonLat","hdms","toStringHDMS","getHDMS","elevation","getMultiCoordsFromNextFeature","feature","nextFeature","gpxVectorLayer","multiLine","getMultiLineStringFeature","getSource","getFeatures","Error","multiLineCoords","getGeometry","getCoordinates","featureIndex","getFeatureIndexInMultiLine","nextFeatureIndex","multiCoords","data","reduce","accumulator","currentValue","i","length","nextValue","distance","LineString","getLength","currentElevation","elevationGainDown","abs","elevationGainUp","distanceInKm","toFixed","getDataFromMultiCoords","slice","features","find","getType","getPointFeatures","filter","closestPointInMultiLine","getClosestPoint","findIndex","coord","isGpxWayPoint","getId","GpxSource","memo","gpxUrl","vectorLayer","onReady","dispatch","useDispatch","useEffect","showSpinner","format","GPX","readExtensions","extensionsNode","Array","from","getElementsByTagName","forEach","node","name","getAttribute","text","textContent","setProperties","source","VectorSource","url","setSource","once","getState","STATE","READY","hideSpinner","dispose","imageIcon","Icon","anchor","src","yellowMarker","getFeatureStyle","showLabel","showImage","showRoute","fontFamily","getProperties","type","textStyleOpts","Text","font","overflow","offsetY","offsetX","textAlign","fill","Fill","color","stroke","Stroke","width","Style","image","undefined","zIndex","routeStyleOpts","toString","GpxLayer","map","onSourceReady","onSelectPointFeature","showMarkers","selectedFeature","children","showFeatureLabels","useState","gpxMarkers","setGpxMarkers","useMemo","VectorLayer","declutter","onMapPointerMove","useCallback","evt","originalEvent","target","nodeName","toLowerCase","pixel","getEventPixel","forEachFeatureAtPixel","push","pointFeature","getTarget","style","cursor","onMapClick","getFeaturesAtPixel","hitTolerance","preventDefault","vectorSource","setStyle","addLayer","getStyle","setImage","setZIndex","on","MapBrowserEventType","POINTERMOVE","CLICK","un","DownloadControlButton","ControlButton","forwardRef","ref","label","tooltipPlacement","rest","button","Button","aria-label","Tooltip","title","placement","arrow","LAYER_ID","FEATURE_ID","MyLocationControlButton","_feature","Feature","setId","marker","_vectorLayer","set","removeLayer","onGetCurrentPosition","position","fromLonLat","longitude","latitude","getFeatureById","setGeometry","Point","getView","animate","center","duration","onClick","navigator","id","getLayers","getArray","layer","get","getLayerById","geolocation","getCurrentPosition","alert","PdfExportControlButton","onButtonCLick","a","exportMapToPDF","save","ZoomToExtentControlButton","fit","ZoomInControlButton","zoom","getZoom","ZoomOutControlButton","useStyles","makeStyles","theme","createStyles","root","padding","spacing","direction","formControl","display","marginBottom","selectPaper","left","maxHeight","top","Settings","classes","settings","useSelector","state","isLoading","spinner","isVisible","onFieldChange","event","checked","value","updateSettings","Paper","className","FormControl","variant","margin","fullWidth","InputLabel","Select","onChange","disabled","MenuProps","paper","disablePortal","routes","route","MenuItem","mapUrl","maps","FormGroup","FormControlLabel","control","Checkbox","popover","marginTop","typography","SettingsToggleControlButton","anchorRef","useRef","isOpen","setIsOpen","ClickAwayListener","onClickAway","Popper","open","anchorEl","current","TransitionProps","Grow","in","timeout","actionsContainer","right","zoomContainer","bottom","buttonGroup","background","palette","common","white","buttonGroupVertical","MapControls","Fade","ButtonGroup","orientation","classNames","urls","expandUrl","flat","TileLayer","props","xyzSource","rasterLayer","OSM","Tile","this","setUrl","href","URL","origin","rel","Component","height","PointData","lon","lat","Table","TableBody","TableRow","TableCell","NextPointControlButton","PrevPointControlButton","ZoomToPointControlButton","_extends","Object","assign","arguments","key","prototype","hasOwnProperty","call","apply","_objectWithoutProperties","excluded","sourceKeys","keys","indexOf","_objectWithoutPropertiesLoose","getOwnPropertySymbols","sourceSymbolKeys","propertyIsEnumerable","d","_ref3","Svg36024Px","_ref","svgRef","titleId","viewBox","ForwardRef","iframe","Google360ControlButton","pointName","embedUrl","modalOpen","setModalOpen","Portal","container","document","body","frameBorder","border","allowFullScreen","WaypointControlButtons","prevFeature","selectFeature","google360Url","size","disableElevation","TabPanel","index","role","hidden","aria-labelledby","NextPointData","WaypointDrawerTabs","React","setValue","Tabs","indicatorColor","textColor","newValue","Tab","toolbar","justifyContent","drawer","drawerPaper","boxShadow","shadows","WaypointDrawer","onClose","useTheme","window","Drawer","ModalProps","keepMounted","Toolbar","Typography","IconButton","edge","Divider","Box","mb","createPointTextFeature","createPointTextStyle","StartFinishLayer","startEndVectorLayer","startEndSource","toggleMarkers","show","setVisible","addFeatures","gpxVectorSource","multiLineStringGeometry","startFeature","getFirstCoordinate","endFeature","getLastCoordinate","onGpxVectorLayerStateChange","initialState","Map","mapRef","createRef","isWaypointDrawerOpen","setIsWaypointDrawerOpen","setSelectedFeature","sortedPointFeatures","setSortedPointFeatures","showControls","OLMap","pixelRatio","controls","sortedPointIndex","getNextFeature","getPrevFeature","onWaypointDrawerClose","lng","view","View","setTarget","setView","onGpxSourceReady","sortedFeatures","points","point","featurePoint","sort","b","getSortedPointFeatures","content","MapPage"],"mappings":"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","file":"static/js/map-page.bb25c02d.chunk.js","sourcesContent":["export const PDF_OPTION_ALL = 'all';\nexport const PDF_OPTION_CURRENT = 'current';\nexport const PDFDims = {\n  a0: [1189, 841],\n  a1: [841, 594],\n  a2: [594, 420],\n  a3: [420, 297],\n  a4: [297, 210],\n  a5: [210, 148],\n};\n\nexport const START_POINT_ID = 'startPoint';\nexport const FINISH_POINT_ID = 'finishPoint';\nexport const START_POINT_LABEL = 'Start';\nexport const FINISH_POINT_LABEL = 'Finish';\n","import { Coordinate, toStringHDMS } from 'ol/coordinate';\nimport Feature, { FeatureLike } from 'ol/Feature';\nimport Geometry from 'ol/geom/Geometry';\nimport GeometryType from 'ol/geom/GeometryType';\nimport LineString from 'ol/geom/LineString';\nimport MultiLineString from 'ol/geom/MultiLineString';\nimport Point from 'ol/geom/Point';\nimport VectorLayer from 'ol/layer/Vector';\nimport { default as OLMap } from 'ol/Map';\nimport { toLonLat } from 'ol/proj';\nimport VectorSource from 'ol/source/Vector';\nimport { START_POINT_ID, FINISH_POINT_ID } from './constants';\n\nconst { MULTI_LINE_STRING, POINT } = GeometryType;\n\nexport const getHDMS = (coordinate: Coordinate): string => {\n  const lonLat = toLonLat(coordinate);\n  const hdms = toStringHDMS(lonLat);\n  return hdms;\n};\n\nexport const getElevation = (coordinate: Coordinate): number => {\n  const elevation = Math.round(coordinate[2]);\n  return elevation;\n};\n\nexport interface DataMultiCoords {\n  distance: number;\n  elevationGainUp: number;\n  elevationGainDown: number;\n  distanceInKm: string;\n}\n\nexport const getDataFromMultiCoords = (\n  multiCoords: Coordinate[]\n): DataMultiCoords => {\n  const data = multiCoords.reduce<DataMultiCoords>(\n    (accumulator, currentValue, i) => {\n      if (i === multiCoords.length - 1) {\n        return accumulator;\n      }\n      const nextValue = multiCoords[i + 1];\n\n      accumulator.distance += new LineString([\n        currentValue,\n        nextValue,\n      ]).getLength();\n\n      const currentElevation = getElevation(currentValue);\n      const nextElevation = getElevation(nextValue);\n      const elevation = nextElevation - currentElevation;\n\n      if (elevation < 0) {\n        accumulator.elevationGainDown += Math.abs(elevation);\n      } else {\n        accumulator.elevationGainUp += elevation;\n      }\n\n      return accumulator;\n    },\n    {\n      distance: 0,\n      elevationGainUp: 0,\n      elevationGainDown: 0,\n      distanceInKm: '',\n    }\n  );\n  data.distanceInKm = (data.distance / 1000).toFixed(2);\n  return data;\n};\n\ninterface DataCoords {\n  lonLat: Coordinate;\n  hdms: string;\n  elevation: number;\n}\n\nexport const getDataFromCoords = (coords: Coordinate): DataCoords => {\n  const lonLat = toLonLat(coords);\n  const hdms = getHDMS(coords);\n  const elevation = getElevation(coords);\n  return { lonLat, hdms, elevation };\n};\n\nexport const getNextFeature = (\n  feature: Feature<Point>,\n  // gpxVectorLayer: VectorLayer,\n  sortedPointFeatures: Feature<Point>[]\n): Feature<Point> => {\n  const sortedPointIndex = sortedPointFeatures.indexOf(feature);\n  const nextPoint = sortedPointFeatures[sortedPointIndex + 1];\n  return nextPoint;\n};\n\nexport const getPrevFeature = (\n  feature: Feature<Point>,\n  sortedPointFeatures: Feature<Point>[]\n): Feature<Point> => {\n  const sortedPointIndex = sortedPointFeatures.indexOf(feature);\n  const nextPoint = sortedPointFeatures[sortedPointIndex - 1];\n  return nextPoint;\n};\n\nexport const getMultiCoordsFromNextFeature = (\n  feature: Feature<Point>,\n  nextFeature: Feature<Point>,\n  gpxVectorLayer: VectorLayer\n): DataMultiCoords => {\n  const multiLine = getMultiLineStringFeature(\n    gpxVectorLayer.getSource().getFeatures()\n  );\n  if (!multiLine) {\n    throw new Error('unable to find multiLine feature in gpx vector layer');\n  }\n  const multiLineCoords = multiLine.getGeometry().getCoordinates()[0];\n  const featureIndex = getFeatureIndexInMultiLine(feature, multiLine);\n  const nextFeatureIndex = getFeatureIndexInMultiLine(nextFeature, multiLine);\n  const multiCoords = multiLineCoords.slice(featureIndex, nextFeatureIndex);\n  return getDataFromMultiCoords(multiCoords);\n};\n\nexport const getLayerById = <T>(map: OLMap, id: string): T | undefined =>\n  (map\n    .getLayers()\n    .getArray()\n    .find((layer) => layer.get('id') === id) as unknown) as T;\n\nexport const getMultiLineStringFeature = (\n  features: Feature<Geometry>[]\n): Feature<MultiLineString> | undefined => {\n  return features.find(\n    (feature) => feature.getGeometry().getType() === MULTI_LINE_STRING\n  ) as Feature<MultiLineString>;\n};\n\nexport const getPointFeatures = (\n  features: Feature<Geometry>[]\n): Feature<Point>[] =>\n  features.filter(\n    (feature) => feature.getGeometry().getType() === POINT\n  ) as Feature<Point>[];\n\nexport interface SortedPointFeature {\n  featurePoint: Feature<Point>;\n  closestPointInMultiLine: Coordinate;\n  index: number;\n}\n\nexport const getFeatureIndexInMultiLine = (\n  feature: Feature<Point>,\n  multiLine: Feature<MultiLineString>\n): number => {\n  const multiLineCoords = multiLine.getGeometry().getCoordinates()[0];\n  const closestPointInMultiLine = multiLine\n    .getGeometry()\n    .getClosestPoint(feature.getGeometry().getCoordinates());\n  const margin = 50; // meters\n  const closesPointIndex = multiLineCoords.findIndex(\n    (coord) =>\n      new LineString([coord, closestPointInMultiLine]).getLength() < margin\n  );\n  return closesPointIndex;\n};\n\nexport const getSortedPointFeatures = (\n  vectorSource: VectorSource\n): Feature<Point>[] => {\n  const points = getPointFeatures(vectorSource.getFeatures());\n  const multiLine = getMultiLineStringFeature(vectorSource.getFeatures());\n  if (!multiLine) {\n    throw new Error(\n      'getSortedPointFeatures: unable to find multiLine feature in gpx vector layer'\n    );\n  }\n  const pointsInMultiLine = points.map((point) => {\n    const featureIndex = getFeatureIndexInMultiLine(point, multiLine);\n    return {\n      featurePoint: point,\n      index: featureIndex,\n    };\n  });\n\n  const sortedPointsInMultiline = pointsInMultiLine.sort(\n    (a, b) => a.index - b.index\n  );\n  return sortedPointsInMultiline.map(({ featurePoint }) => featurePoint);\n};\n\nexport const sampleCoordinates = (\n  coords: Coordinate[],\n  minDistanceThreshold = 0\n): {\n  coord: Coordinate;\n  distance: number;\n  distanceFromStart: number;\n}[] => {\n  let curMinDistance = 0;\n  let distanceFromStart = 0;\n  return coords\n    .map((coord, i) => {\n      const distance =\n        i === 0 ? 0 : new LineString([coords[i - 1], coord]).getLength(); // meter\n      distanceFromStart += distance;\n      return {\n        coord,\n        distance,\n        distanceFromStart,\n      };\n    })\n    .filter((point, i) => {\n      curMinDistance += point.distance;\n      if (!i || curMinDistance > minDistanceThreshold) {\n        curMinDistance = 0;\n        return true;\n      }\n      return false;\n    });\n};\n\nexport function isGpxWayPoint(feature: FeatureLike): feature is Feature<Point> {\n  return (\n    feature.getGeometry().getType() === GeometryType.POINT &&\n    feature.getId() !== START_POINT_ID &&\n    feature.getId() !== FINISH_POINT_ID\n  );\n}\n","import GPX from 'ol/format/GPX';\nimport VectorLayer from 'ol/layer/Vector';\nimport STATE from 'ol/source/State';\nimport VectorSource from 'ol/source/Vector';\nimport { memo, useEffect } from 'react';\nimport { useDispatch } from 'react-redux';\nimport { hideSpinner, showSpinner } from '../../features/spinner';\n\nconst EXTENSIONS_TAG_NAME = 'gr20';\n\nexport interface GpxSourceProps {\n  gpxUrl: string;\n  vectorLayer: VectorLayer;\n  onReady: (vectorSource: VectorSource) => void;\n}\n\nexport const GpxSource: React.FunctionComponent<GpxSourceProps> = memo(\n  ({ gpxUrl, vectorLayer, onReady }) => {\n    const dispatch = useDispatch();\n\n    useEffect(() => {\n      dispatch(showSpinner());\n      const format = new GPX({\n        readExtensions(feature, extensionsNode) {\n          if (!extensionsNode) {\n            return;\n          }\n          const gr20Nodes = [\n            ...Array.from(\n              (extensionsNode as Element).getElementsByTagName(\n                EXTENSIONS_TAG_NAME\n              )\n            ),\n          ];\n          gr20Nodes.forEach((node) => {\n            const name = node.getAttribute('name');\n            if (name) {\n              const text = node.textContent;\n              feature.setProperties({\n                [name]: text,\n              });\n            }\n          });\n        },\n      });\n      const source = new VectorSource({\n        url: gpxUrl,\n        format,\n      });\n      vectorLayer.setSource(source);\n      source.once('change', () => {\n        if (source.getState() === STATE.READY) {\n          dispatch(hideSpinner());\n          onReady(source);\n        }\n      });\n\n      return () => {\n        source.dispose();\n      };\n    }, [dispatch, gpxUrl, onReady, vectorLayer]);\n    return null;\n  }\n);\n","export default __webpack_public_path__ + \"static/media/baseline-location_on-24px-yellow.1a07b598.svg\";","import Icon from 'ol/style/Icon';\nimport Stroke from 'ol/style/Stroke';\nimport Style from 'ol/style/Style';\nimport yellowMarker from './baseline-location_on-24px-yellow.svg';\nimport Text from 'ol/style/Text';\nimport Fill from 'ol/style/Fill';\nimport GeometryType from 'ol/geom/GeometryType';\nimport { FeatureLike } from 'ol/Feature';\n\nexport const imageIcon = new Icon({\n  anchor: [0.5, 1],\n  src: yellowMarker,\n});\n\nexport function getFeatureStyle(\n  feature: FeatureLike,\n  showLabel: boolean,\n  showImage: boolean,\n  showRoute: boolean,\n  fontFamily = 'Calibri,sans-serif'\n): Style {\n  const { name } = feature.getProperties();\n  const type = feature.getGeometry().getType();\n  switch (type) {\n    case GeometryType.POINT:\n      const textStyleOpts = new Text({\n        text: name,\n        font: `bold 13px ${fontFamily}`,\n        overflow: false,\n        offsetY: -10,\n        offsetX: 12,\n        textAlign: 'left',\n        fill: new Fill({\n          color: '#fff',\n        }),\n        stroke: new Stroke({\n          color: '#000',\n          width: 1,\n        }),\n      });\n      return new Style({\n        image: showImage ? imageIcon : undefined,\n        text: showLabel ? textStyleOpts : undefined,\n        zIndex: 2,\n      });\n    case GeometryType.MULTI_LINE_STRING:\n      const routeStyleOpts = {\n        stroke: new Stroke({\n          color: 'rgba(0,60,136)',\n          width: 4,\n        }),\n        zIndex: 1,\n      };\n      return new Style(showRoute ? routeStyleOpts : undefined);\n    default:\n      throw new Error('No styles for ' + type.toString());\n  }\n}\n","import Feature, { FeatureLike } from 'ol/Feature';\nimport Geometry from 'ol/geom/Geometry';\nimport MultiLineString from 'ol/geom/MultiLineString';\nimport Point from 'ol/geom/Point';\nimport { Vector as VectorLayer } from 'ol/layer';\nimport { default as OLMap } from 'ol/Map';\nimport VectorSource from 'ol/source/Vector';\nimport React, {\n  Fragment,\n  memo,\n  ReactNode,\n  useCallback,\n  useEffect,\n  useMemo,\n  useState,\n} from 'react';\nimport { getPointFeatures, isGpxWayPoint } from '../../util/util';\nimport { GpxSource } from './GpxSource';\nimport selectedPin from './selected-pin.png';\nimport Style from 'ol/style/Style';\nimport Icon from 'ol/style/Icon';\nimport MapBrowserEventType from 'ol/MapBrowserEventType';\nimport MapBrowserEvent from 'ol/MapBrowserEvent';\nimport { getFeatureStyle } from './GpxLayerStyles';\n\nexport interface GpxLayerProps {\n  map: OLMap;\n  gpxUrl: string;\n  selectedFeature?: Feature<Point>;\n  showMarkers: boolean;\n  showRoute: boolean;\n  showFeatureLabels?: boolean;\n  onSourceReady: (vectorSource: VectorSource) => void;\n  onSelectPointFeature: (feature?: Feature<Point>) => void;\n  children: (\n    gpxVectorLayer: VectorLayer,\n    multiLineStringFeature?: Feature<MultiLineString>\n  ) => ReactNode;\n}\n\nexport const GpxLayer: React.FunctionComponent<GpxLayerProps> = memo(\n  ({\n    map,\n    onSourceReady,\n    onSelectPointFeature,\n    gpxUrl,\n    showMarkers,\n    showRoute,\n    selectedFeature,\n    children,\n    showFeatureLabels = false,\n  }) => {\n    const [gpxMarkers, setGpxMarkers] = useState<Feature<Geometry>[]>([]);\n\n    const vectorLayer = useMemo(\n      () =>\n        new VectorLayer({\n          declutter: false,\n        }),\n      []\n    );\n\n    const onMapPointerMove = useCallback(\n      (evt: MapBrowserEvent<UIEvent>) => {\n        if (\n          (evt.originalEvent?.target as HTMLElement).nodeName.toLowerCase() ===\n          'canvas'\n        ) {\n          const pixel = map.getEventPixel(evt.originalEvent);\n          const features: FeatureLike[] = [];\n          map.forEachFeatureAtPixel(pixel, (feature) => {\n            features.push(feature);\n          });\n          const pointFeature = features.find(isGpxWayPoint);\n          (map.getTarget() as HTMLDivElement).style.cursor = pointFeature\n            ? 'pointer'\n            : '';\n        }\n      },\n      [map]\n    );\n\n    const onMapClick = useCallback(\n      (evt: MapBrowserEvent<UIEvent>) => {\n        const features = map.getFeaturesAtPixel(evt.pixel, { hitTolerance: 4 });\n        const feature = features.find(isGpxWayPoint);\n        if (feature) {\n          evt.preventDefault();\n        }\n        onSelectPointFeature(feature);\n      },\n      [map, onSelectPointFeature]\n    );\n\n    const onReady = useCallback(\n      (vectorSource: VectorSource) => {\n        onSourceReady(vectorSource);\n        const features = vectorSource.getFeatures();\n        setGpxMarkers(getPointFeatures(features));\n      },\n      [onSourceReady]\n    );\n\n    useEffect(() => {\n      vectorLayer.setStyle((feature) => {\n        return getFeatureStyle(\n          feature,\n          showFeatureLabels,\n          showMarkers,\n          showRoute\n        );\n      });\n    }, [showFeatureLabels, showMarkers, showRoute, vectorLayer]);\n\n    useEffect(() => {\n      map.addLayer(vectorLayer);\n    }, [map, vectorLayer]);\n\n    useEffect(() => {\n      gpxMarkers.forEach((feature) => {\n        feature.setStyle(\n          getFeatureStyle(feature, showFeatureLabels, showMarkers, showRoute)\n        );\n      });\n      (selectedFeature?.getStyle() as Style)?.setImage(\n        new Icon({\n          anchor: [0.5, 1],\n          src: selectedPin,\n        })\n      );\n      (selectedFeature?.getStyle() as Style)?.setZIndex(3);\n    }, [\n      gpxMarkers,\n      map,\n      selectedFeature,\n      showFeatureLabels,\n      showMarkers,\n      showRoute,\n    ]);\n\n    useEffect(() => {\n      map.on(MapBrowserEventType.POINTERMOVE, onMapPointerMove);\n      map.on(MapBrowserEventType.CLICK, onMapClick);\n      return () => {\n        map.un(MapBrowserEventType.POINTERMOVE, onMapPointerMove);\n        map.un(MapBrowserEventType.CLICK, onMapClick);\n      };\n    }, [map, onMapClick, onMapPointerMove]);\n\n    return (\n      <Fragment>\n        <GpxSource\n          gpxUrl={gpxUrl}\n          vectorLayer={vectorLayer}\n          onReady={onReady}\n        />\n        {children && children(vectorLayer)}\n      </Fragment>\n    );\n  }\n);\n","export default \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABwAAAApCAMAAAARZLm4AAAACXBIWXMAAAAcAAAAHAAPAbmPAAAAaVBMVEUAAADqQzXqQzXqQzXqQzUAAAAAAADqQzXePzUAAADqQzXqQzXqQzUAAADmQzXqTzzqQzXqQzniSzzvSzzqQzU/GREAAADqRznqQzWmDQ2uFRXKLSXWNSm6HRm+IR22GRW6IRm2HRnaNSne5JaTAAAAGHRSTlMAzuqmkAYKSxkNV97GCH8NvjUREe8hFSkSl0uZAAABDklEQVR42u39V5LDIAxAAdDdE/fFJfX+h1xsEImxmN0LvC+LN8KoHID8j0aUTGtWiuakEqo9NDmoK9cH+PXjUqoDaOrzTs5YyOUagbu3aBT7KopLutfnw2Wepnnx4VavgOA+7TwhFkaW7nudHJBbGsnc9wPk7A6YkXDL5IGTvyRc+wL3+LqWhg9a3QH9bt5i3R3irYE5BPp9m+fb6sN8mwnTKGyfywWXwo4TTWWtnVmOyZzEp839Dl2L0BWdl+SnD+Rhd5PIDy2HegQJqD+ulqHs/KNYSk74RUsIgts0jjnXxj5FpX3xBXek3WQkUSrT41pJVFaZGc8lqyJyKIohIqXKxjGLXEtkpVQVcWd+AYihOu4Eb3/8AAAAAElFTkSuQmCC\"","import { default as OLMap } from 'ol/Map';\nimport VectorSource from 'ol/source/Vector';\nimport React, { Fragment, memo } from 'react';\n// import { useDispatch } from 'react-redux';\n// import { hideSpinner, showSpinner } from '../../../features/spinner';\n// import GetAppIcon from '@material-ui/icons/GetApp';\nimport {\n  // ControlButton,\n  ControlButtonProps,\n} from '../ControlButton/ControlButton';\n// import { INPUT_TYPES } from '../../Form/Form';\n// import ModalHeader from 'reactstrap/lib/ModalHeader';\n// import Modal from 'reactstrap/lib/Modal';\n// import ModalBody from 'reactstrap/lib/ModalBody';\n// import Form from 'reactstrap/lib/Form';\n// import FormGroup from 'reactstrap/lib/FormGroup';\n// import Label from 'reactstrap/lib/Label';\n// import Input from 'reactstrap/lib/Input';\n// import Col from 'reactstrap/lib/Col';\n// import Alert from 'reactstrap/lib/Alert';\n// import Button from 'reactstrap/lib/Button';\n// import { PDF_OPTION_ALL, PDF_OPTION_CURRENT } from '../../../util/constants';\nimport { PDFFormat } from '../../../util/types';\n\nexport interface DownloadControlButtonProps {\n  map: OLMap;\n  source: VectorSource;\n}\n\nexport interface DownloadOptions {\n  includeGPX: boolean;\n  includePDF: boolean;\n  pdfOption: 'all' | 'current';\n  pdfFormat: PDFFormat;\n  pdfResolution: number;\n}\n\nexport const DownloadControlButton: React.FunctionComponent<\n  DownloadControlButtonProps & Omit<ControlButtonProps, 'onClick'>\n> = memo(({ map, source, ...rest }) => {\n  // const [modalOpen, setModalOpen] = useState<boolean>(false);\n  // const [downloadOptions, setDownloadOptions] = useState<DownloadOptions>({\n  //   includeGPX: true,\n  //   includePDF: true,\n  //   pdfOption: 'all',\n  //   pdfFormat: 'a4',\n  //   pdfResolution: 150,\n  // });\n\n  // const dispatch = useDispatch();\n\n  // const onButtonCLick = () => {\n  //   setModalOpen(true);\n  // };\n\n  // const onChange = (name: string, value: string | boolean) => {\n  //   setDownloadOptions({\n  //     ...downloadOptions,\n  //     [name]: value,\n  //   });\n  // };\n\n  // const onFieldChange = ({ target }: { target: HTMLInputElement }) => {\n  //   const { name, type, checked, value: targetValue } = target;\n  //   const value = type === INPUT_TYPES.checkbox ? checked : targetValue;\n  //   onChange(name, value);\n  // };\n\n  // const download = async () => {\n  //   const { downloadZipFile } = await import(\n  //     /* webpackChunkName: \"download-util\" */ '../../../util/download'\n  //   );\n  //   const {\n  //     pdfFormat,\n  //     pdfResolution,\n  //     includePDF,\n  //     includeGPX,\n  //     pdfOption,\n  //   } = downloadOptions;\n  //   await downloadZipFile(\n  //     map,\n  //     source,\n  //     includeGPX,\n  //     includePDF,\n  //     pdfFormat,\n  //     pdfResolution,\n  //     pdfOption,\n  //     () => dispatch(showSpinner()),\n  //     () => dispatch(hideSpinner())\n  //   );\n  // };\n\n  // const onDownloadButtonClick = () => {\n  //   setModalOpen(false);\n  //   void download(); // FIXME: handle error\n  // };\n\n  // const toggle = () => {\n  //   setModalOpen(!modalOpen);\n  // };\n\n  return (\n    <Fragment>\n      {/* <ControlButton {...rest} onClick={onButtonCLick}>\n        <GetAppIcon />\n      </ControlButton> */}\n      {/* <Modal isOpen={modalOpen} toggle={toggle} centered>\n        <ModalHeader toggle={toggle}>Download Options</ModalHeader>\n        <ModalBody>\n          <Form>\n            <FormGroup>\n              <FormGroup check>\n                <Label check>\n                  <Input\n                    type=\"checkbox\"\n                    name=\"includeGPX\"\n                    checked={downloadOptions.includeGPX}\n                    onChange={onFieldChange}\n                  />{' '}\n                  Include GPX\n                </Label>\n              </FormGroup>\n              <FormGroup check>\n                <Label check>\n                  <Input\n                    type=\"checkbox\"\n                    name=\"includePDF\"\n                    checked={downloadOptions.includePDF}\n                    onChange={onFieldChange}\n                  />{' '}\n                  Include PDF\n                </Label>\n              </FormGroup>\n              {downloadOptions.includePDF && (\n                <FormGroup style={{ paddingLeft: '1.5em' }}>\n                  <FormGroup row>\n                    <Label for=\"pdfFormat\" sm={4}>\n                      Page size\n                    </Label>\n                    <Col sm={8}>\n                      <Input\n                        type=\"select\"\n                        id=\"pdfFormat\"\n                        onChange={onFieldChange}\n                        name=\"pdfFormat\"\n                        value={downloadOptions.pdfFormat}\n                      >\n                        <option value=\"a0\">A0 (slow)</option>\n                        <option value=\"a1\">A1</option>\n                        <option value=\"a2\">A2</option>\n                        <option value=\"a3\">A3</option>\n                        <option value=\"a4\">A4</option>\n                        <option value=\"a5\">A5 (fast)</option>\n                      </Input>\n                    </Col>\n                  </FormGroup>\n                  <FormGroup row>\n                    <Label for=\"pdfFormat\" sm={4}>\n                      Resolution\n                    </Label>\n                    <Col sm={8}>\n                      <Input\n                        type=\"select\"\n                        id=\"pdfResolution\"\n                        onChange={onFieldChange}\n                        name=\"pdfResolution\"\n                        value={downloadOptions.pdfResolution}\n                      >\n                        <option value=\"72\">72 dpi (fast)</option>\n                        <option value=\"150\">150 dpi</option>\n                        <option value=\"300\">300 dpi (slow)</option>\n                      </Input>\n                    </Col>\n                  </FormGroup>\n                  <FormGroup row>\n                    <Label sm={4}>Pages</Label>\n                    <Col sm={8}>\n                      <FormGroup check>\n                        <Label check>\n                          <Input\n                            type=\"radio\"\n                            name=\"pdfOption\"\n                            value={PDF_OPTION_ALL}\n                            checked={\n                              downloadOptions.pdfOption === PDF_OPTION_ALL\n                            }\n                            onChange={onFieldChange}\n                          />{' '}\n                          All Stages\n                        </Label>\n                      </FormGroup>\n                      <FormGroup check>\n                        <Label check>\n                          <Input\n                            type=\"radio\"\n                            name=\"pdfOption\"\n                            value={PDF_OPTION_CURRENT}\n                            checked={\n                              downloadOptions.pdfOption === PDF_OPTION_CURRENT\n                            }\n                            onChange={onFieldChange}\n                          />{' '}\n                          Current View\n                        </Label>\n                      </FormGroup>\n                    </Col>\n                  </FormGroup>\n                </FormGroup>\n              )}\n            </FormGroup>\n            {downloadOptions.includePDF &&\n              downloadOptions.pdfOption === PDF_OPTION_ALL && (\n                <Alert color=\"warning\">\n                  Please note it might take some time to generate the PDF.\n                </Alert>\n              )}\n\n            <Button\n              onClick={onDownloadButtonClick}\n              disabled={\n                !downloadOptions.includeGPX && !downloadOptions.includePDF\n              }\n            >\n              Download\n            </Button>\n          </Form>\n        </ModalBody>\n      </Modal> */}\n    </Fragment>\n  );\n});\n","import React, { forwardRef, memo } from 'react';\nimport Tooltip from '@material-ui/core/Tooltip';\nimport { PopperPlacementType } from '@material-ui/core/Popper';\nimport Button, { ButtonProps } from '@material-ui/core/Button';\n\nexport type ControlButtonProps = ButtonProps & {\n  label?: string;\n  tooltipPlacement?: PopperPlacementType;\n};\n\nexport const ControlButton: React.FunctionComponent<ControlButtonProps> = memo(\n  forwardRef(\n    ({ children, label, tooltipPlacement = 'bottom', ...rest }, ref) => {\n      const button = (\n        <Button {...rest} aria-label={label} ref={ref}>\n          {children}\n        </Button>\n      );\n\n      return label ? (\n        <Tooltip title={label} placement={tooltipPlacement} arrow>\n          {button}\n        </Tooltip>\n      ) : (\n        button\n      );\n    }\n  )\n);\n","export default __webpack_public_path__ + \"static/media/baseline-my_location-24px-yellow.bf46ab87.svg\";","import Feature from 'ol/Feature';\nimport Point from 'ol/geom/Point';\nimport VectorLayer from 'ol/layer/Vector';\nimport { default as OLMap } from 'ol/Map';\nimport { fromLonLat } from 'ol/proj';\nimport VectorSource from 'ol/source/Vector';\nimport Icon from 'ol/style/Icon';\nimport Style from 'ol/style/Style';\nimport React, { useEffect, useMemo } from 'react';\nimport { useDispatch } from 'react-redux';\nimport { hideSpinner, showSpinner } from '../../../features/spinner';\nimport { getLayerById } from '../../../util/util';\nimport {\n  ControlButton,\n  ControlButtonProps,\n} from '../ControlButton/ControlButton';\nimport marker from './baseline-my_location-24px-yellow.svg';\nimport MyLocationIcon from '@material-ui/icons/MyLocation';\nconst LAYER_ID = 'mylocation_layer';\nconst FEATURE_ID = 'mylocation_feature';\nconst ANIMATION_DURATION = 1000;\n\nexport interface MyLocationControlButtonProps {\n  map: OLMap;\n}\n\nexport const MyLocationControlButton: React.FunctionComponent<\n  MyLocationControlButtonProps & Omit<ControlButtonProps, 'onClick'>\n> = ({ map, ...rest }) => {\n  const dispatch = useDispatch();\n\n  const feature = useMemo<Feature>(() => {\n    const _feature = new Feature({\n      name: 'My Location',\n    });\n    _feature.setId(FEATURE_ID);\n    _feature.setStyle(\n      new Style({\n        image: new Icon({\n          anchor: [0.5, 0.5],\n          src: marker,\n        }),\n      })\n    );\n    return _feature;\n  }, []);\n\n  const vectorLayer = useMemo<VectorLayer>(() => {\n    const _vectorLayer = new VectorLayer({\n      source: new VectorSource({\n        features: [feature],\n      }),\n    });\n    _vectorLayer.set('id', LAYER_ID);\n    return _vectorLayer;\n  }, [feature]);\n\n  useEffect(() => {\n    return () => {\n      map.removeLayer(vectorLayer);\n    };\n  }, [feature, vectorLayer, map]);\n\n  const onGetCurrentPosition = (position: Position) => {\n    dispatch(hideSpinner());\n\n    const coords = fromLonLat([\n      position.coords.longitude,\n      position.coords.latitude,\n    ]);\n\n    vectorLayer\n      .getSource()\n      .getFeatureById(FEATURE_ID)\n      .setGeometry(new Point(coords));\n\n    map.getView().animate({\n      center: coords,\n      duration: ANIMATION_DURATION,\n    });\n  };\n\n  const onButtonCLick = () => {\n    if ('geolocation' in navigator) {\n      dispatch(showSpinner());\n      if (!getLayerById(map, LAYER_ID)) {\n        map.addLayer(vectorLayer);\n      }\n      navigator.geolocation.getCurrentPosition(onGetCurrentPosition);\n    } else {\n      // eslint-disable-next-line no-alert\n      alert('Geolocation is not supported in your browser');\n    }\n  };\n\n  return (\n    <ControlButton onClick={onButtonCLick} {...rest}>\n      <MyLocationIcon />\n    </ControlButton>\n  );\n};\n","import { default as OLMap } from 'ol/Map';\nimport React from 'react';\nimport { useDispatch } from 'react-redux';\nimport PictureAsPdfIcon from '@material-ui/icons/PictureAsPdf';\nimport { hideSpinner, showSpinner } from '../../../features/spinner';\nimport {\n  ControlButton,\n  ControlButtonProps,\n} from '../ControlButton/ControlButton';\n\nexport interface PdfExportControlButtonProps {\n  map: OLMap;\n}\n\nexport const PdfExportControlButton: React.FunctionComponent<\n  PdfExportControlButtonProps & Omit<ControlButtonProps, 'onClick'>\n> = ({ map, ...rest }) => {\n  const dispatch = useDispatch();\n\n  const onButtonCLick = async () => {\n    dispatch(showSpinner());\n    const { exportMapToPDF } = await import(\n      /* webpackChunkName: \"pdf-util\" */ '../../../util/pdf'\n    );\n    const pdf = await exportMapToPDF(map);\n    pdf.save('map.pdf');\n    dispatch(hideSpinner());\n  };\n\n  return (\n    <ControlButton onClick={onButtonCLick} {...rest}>\n      <PictureAsPdfIcon />\n    </ControlButton>\n  );\n};\n","import { default as OLMap } from 'ol/Map';\nimport React from 'react';\nimport ZoomOutMapIcon from '@material-ui/icons/ZoomOutMap';\nimport {\n  ControlButton,\n  ControlButtonProps,\n} from '../ControlButton/ControlButton';\n\nconst ANIMATION_DURATION = 1000;\n\ninterface ZoomToExtentControlButtonProps {\n  map: OLMap;\n}\n\nexport const ZoomToExtentControlButton: React.FunctionComponent<\n  ZoomToExtentControlButtonProps & Omit<ControlButtonProps, 'onClick'>\n> = ({ map, ...rest }) => {\n  const onButtonCLick = () => {\n    const view = map.getView();\n    view.fit(\n      [\n        978823.488305482,\n        5121096.608475749,\n        1039463.1111227559,\n        5245134.752643153,\n      ],\n      {\n        duration: ANIMATION_DURATION,\n      }\n    );\n  };\n\n  return (\n    <ControlButton onClick={onButtonCLick} {...rest}>\n      <ZoomOutMapIcon />\n    </ControlButton>\n  );\n};\n","import { default as OLMap } from 'ol/Map';\nimport React, { memo } from 'react';\nimport ZoomInIcon from '@material-ui/icons/ZoomIn';\n\nimport {\n  ControlButton,\n  ControlButtonProps,\n} from '../ControlButton/ControlButton';\n\nexport const ANIMATION_DURATION = 250;\n\nexport interface ZoomInControlButtonProps {\n  map: OLMap;\n}\n\nexport const ZoomInControlButton: React.FunctionComponent<\n  ZoomInControlButtonProps & Omit<ControlButtonProps, 'onClick'>\n> = memo(({ map, ...rest }) => {\n  const onClick = () => {\n    map.getView().animate({\n      zoom: map.getView().getZoom() + 0.5,\n      duration: ANIMATION_DURATION,\n    });\n  };\n  return (\n    <ControlButton {...rest} tooltipPlacement=\"left\" onClick={onClick}>\n      <ZoomInIcon />\n    </ControlButton>\n  );\n});\n","import { default as OLMap } from 'ol/Map';\nimport React, { memo } from 'react';\nimport ZoomOutIcon from '@material-ui/icons/ZoomOut';\n\nimport {\n  ControlButton,\n  ControlButtonProps,\n} from '../ControlButton/ControlButton';\n\nexport const ANIMATION_DURATION = 250;\n\nexport interface ZoomOutControlButtonProps {\n  map: OLMap;\n}\n\nexport const ZoomOutControlButton: React.FunctionComponent<\n  ZoomOutControlButtonProps & Omit<ControlButtonProps, 'onClick'>\n> = memo(({ map, ...rest }) => {\n  const onClick = () => {\n    map.getView().animate({\n      zoom: map.getView().getZoom() - 0.5,\n      duration: ANIMATION_DURATION,\n    });\n  };\n  return (\n    <ControlButton {...rest} tooltipPlacement=\"left\" onClick={onClick}>\n      <ZoomOutIcon />\n    </ControlButton>\n  );\n});\n","import { createStyles, makeStyles, Theme } from '@material-ui/core/styles';\n\nexport const useStyles = makeStyles((theme: Theme) =>\n  createStyles({\n    root: {\n      overflow: 'auto',\n      padding: theme.spacing(3),\n      textAlign: theme.direction === 'rtl' ? 'right' : 'left',\n      width: 320,\n    },\n    formControl: {\n      display: 'block',\n      marginBottom: theme.spacing(2),\n      '&:last-child': {\n        marginBottom: 0,\n      },\n    },\n    selectPaper: {\n      // hack to fix Material UI popover position when disablePortal is true\n      left: `${theme.spacing(2)}px !important`,\n      maxHeight: 'none !important',\n      top: `${theme.spacing(2)}px !important`,\n    },\n  })\n);\n","import React from 'react';\nimport { useDispatch, useSelector } from 'react-redux';\nimport { updateSettings } from '../../features/settings';\nimport { RootState } from '../../store';\nimport FormControl from '@material-ui/core/FormControl';\nimport InputLabel from '@material-ui/core/InputLabel';\nimport Select from '@material-ui/core/Select';\nimport MenuItem from '@material-ui/core/MenuItem';\n\nimport { routes } from '../../data/routes/routes';\nimport FormControlLabel from '@material-ui/core/FormControlLabel';\nimport Checkbox from '@material-ui/core/Checkbox';\nimport FormGroup from '@material-ui/core/FormGroup';\nimport { useStyles } from './Settings.styles';\nimport { Paper } from '@material-ui/core';\nimport maps from '../../data/maps/maps.json';\n\nexport const Settings: React.FunctionComponent = () => {\n  const classes = useStyles();\n  const settings = useSelector((state: RootState) => state.settings);\n  const { isVisible: isLoading } = useSelector(\n    (state: RootState) => state.spinner\n  );\n  const dispatch = useDispatch();\n\n  const onFieldChange = (\n    event: React.ChangeEvent<{\n      value: unknown;\n      name?: string;\n      type?: string;\n      checked?: boolean;\n    }>\n  ) => {\n    const { name, type, checked, value } = event.target;\n    if (name) {\n      dispatch(\n        updateSettings({\n          [name]: type === 'checkbox' ? checked : value,\n        })\n      );\n    }\n  };\n\n  return (\n    <Paper className={classes.root}>\n      <FormControl variant=\"outlined\" margin=\"normal\" fullWidth>\n        <InputLabel>Route</InputLabel>\n        <Select\n          value={settings.gpxUrl}\n          label=\"Route\"\n          name=\"gpxUrl\"\n          onChange={onFieldChange}\n          disabled={isLoading}\n          MenuProps={{\n            classes: { paper: classes.selectPaper }, // hack to fix ClickAwayListener\n            disablePortal: true, // hack to fix ClickAwayListener\n          }}\n        >\n          {routes.map((route) => (\n            <MenuItem value={route.url}>{route.name}</MenuItem>\n          ))}\n        </Select>\n      </FormControl>\n      <FormControl variant=\"outlined\" margin=\"normal\" fullWidth>\n        <InputLabel>Layer</InputLabel>\n        <Select\n          value={settings.mapUrl}\n          label=\"Layer\"\n          name=\"mapUrl\"\n          onChange={onFieldChange}\n          disabled={isLoading}\n          MenuProps={{\n            classes: { paper: classes.selectPaper }, // hack to fix ClickAwayListener\n            disablePortal: true, // hack to fix ClickAwayListener\n          }}\n        >\n          {maps.map((route) => (\n            <MenuItem value={route.url}>{route.name}</MenuItem>\n          ))}\n        </Select>\n      </FormControl>\n      {/* <FormControlLabel\n        className={classes.formControl}\n        control={\n          <Checkbox\n            onChange={onFieldChange}\n            name=\"showControls\"\n            color=\"primary\"\n            checked={settings.showControls}\n          />\n        }\n        label=\"Show controls\"\n      /> */}\n      <FormControl margin=\"dense\" fullWidth>\n        <FormGroup>\n          <FormControlLabel\n            disabled={isLoading}\n            control={\n              <Checkbox\n                onChange={onFieldChange}\n                name=\"showMarkers\"\n                color=\"primary\"\n                checked={settings.showMarkers}\n              />\n            }\n            key=\"show-markers\"\n            label=\"Show Markers\"\n          />\n          <FormControlLabel\n            disabled={isLoading}\n            control={\n              <Checkbox\n                onChange={onFieldChange}\n                name=\"showRoute\"\n                color=\"primary\"\n                checked={settings.showRoute}\n              />\n            }\n            key=\"show-route\"\n            label=\"Show Route\"\n          />\n          <FormControlLabel\n            disabled={isLoading}\n            control={\n              <Checkbox\n                onChange={onFieldChange}\n                name=\"showFeatureLabels\"\n                color=\"primary\"\n                checked={settings.showFeatureLabels}\n              />\n            }\n            key=\"show-point-labels\"\n            label=\"Show Point Labels\"\n          />\n        </FormGroup>\n      </FormControl>\n    </Paper>\n  );\n};\n","import { createStyles, makeStyles, Theme } from '@material-ui/core/styles';\n\nexport const useStyles = makeStyles((theme: Theme) =>\n  createStyles({\n    root: {\n      display: 'inline-flex',\n    },\n    popover: {\n      marginTop: theme.spacing(2),\n    },\n    typography: {\n      padding: theme.spacing(2),\n    },\n  })\n);\n","import React, { useRef, useState } from 'react';\nimport {\n  ControlButton,\n  ControlButtonProps,\n} from '../ControlButton/ControlButton';\nimport SettingsIcon from '@material-ui/icons/Settings';\nimport { Settings } from '../../Settings/Settings';\nimport Popper from '@material-ui/core/Popper';\nimport ClickAwayListener from '@material-ui/core/ClickAwayListener';\nimport { useStyles } from './SettingsToggleControlButton.styles';\nimport { Grow } from '@material-ui/core';\n\nexport const SettingsToggleControlButton: React.FunctionComponent<Omit<\n  ControlButtonProps,\n  'onClick'\n>> = ({ ...rest }) => {\n  const classes = useStyles();\n  const anchorRef = useRef<HTMLButtonElement | null>(null);\n  const [isOpen, setIsOpen] = useState<boolean>(false);\n\n  const handleButtonClick = (event: React.MouseEvent<HTMLButtonElement>) => {\n    setIsOpen(!isOpen);\n  };\n\n  const handleClose = () => {\n    setIsOpen(false);\n  };\n\n  return (\n    <ClickAwayListener onClickAway={handleClose}>\n      <div className={classes.root}>\n        <ControlButton {...rest} ref={anchorRef} onClick={handleButtonClick}>\n          <SettingsIcon />\n        </ControlButton>\n        <Popper\n          open={isOpen}\n          anchorEl={anchorRef.current}\n          className={classes.popover}\n        >\n          {({ TransitionProps }) => (\n            <Grow {...TransitionProps} in={isOpen} timeout={100}>\n              <div>\n                <Settings />\n              </div>\n            </Grow>\n          )}\n        </Popper>\n      </div>\n    </ClickAwayListener>\n  );\n};\n","import { createStyles, makeStyles, Theme } from '@material-ui/core/styles';\n\nexport const useStyles = makeStyles((theme: Theme) =>\n  createStyles({\n    actionsContainer: {\n      position: 'fixed',\n      right: theme.spacing(1),\n      top: theme.spacing(1),\n      zIndex: 1,\n    },\n    zoomContainer: {\n      position: 'fixed',\n      right: theme.spacing(1),\n      bottom: theme.spacing(1),\n      zIndex: 1,\n    },\n    buttonGroup: {\n      background: theme.palette.common.white,\n      margin: theme.spacing(1),\n    },\n    buttonGroupVertical: {\n      display: 'flex',\n      marginBottom: theme.spacing(2),\n    },\n  })\n);\n","import React, { Fragment } from 'react';\nimport ButtonGroup from '@material-ui/core/ButtonGroup';\nimport classNames from 'classnames/bind';\nimport { default as OLMap } from 'ol/Map';\nimport VectorSource from 'ol/source/Vector';\nimport { DownloadControlButton } from '../ControlButtons/DownloadControlButton/DownloadControlButton';\nimport { MyLocationControlButton } from '../ControlButtons/MyLocationControlButton/MyLocationControlButton';\nimport { PdfExportControlButton } from '../ControlButtons/PdfExportControlButton/PdfExportControlButton';\nimport { ZoomToExtentControlButton } from '../ControlButtons/ZoomToExtentControlButton/ZoomToExtentControlButton';\nimport { ZoomInControlButton } from '../ControlButtons/ZoomInControlButton/ZoomInControlButton';\nimport { ZoomOutControlButton } from '../ControlButtons/ZoomOutControlButton/ZoomOutControlButton';\nimport { SettingsToggleControlButton } from '../ControlButtons/SettingsToggleControlButton/SettingsToggleControlButton';\nimport { useStyles } from './styles';\nimport Fade from '@material-ui/core/Fade';\n\nexport const FADE_TIMEOUT = 800;\n\nexport interface MapControlsProps {\n  map: OLMap;\n  source: VectorSource;\n}\n\nexport const MapControls: React.FunctionComponent<MapControlsProps> = ({\n  map,\n  source,\n}) => {\n  const classes = useStyles();\n  return (\n    <Fragment>\n      <Fade in timeout={FADE_TIMEOUT}>\n        <div className={classes.actionsContainer}>\n          <ButtonGroup\n            orientation=\"horizontal\"\n            variant=\"text\"\n            className={classes.buttonGroup}\n          >\n            <ZoomToExtentControlButton label=\"Fit Extent\" map={map} />\n            <PdfExportControlButton label=\"Export to PDF\" map={map} />\n            <DownloadControlButton\n              label=\"Download Route and Maps\"\n              source={source}\n              map={map}\n            />\n            <MyLocationControlButton label=\"Show My Location\" map={map} />\n          </ButtonGroup>\n          <ButtonGroup\n            orientation=\"horizontal\"\n            variant=\"text\"\n            className={classes.buttonGroup}\n          >\n            <SettingsToggleControlButton label=\"Settings\" />\n          </ButtonGroup>\n        </div>\n      </Fade>\n      <Fade in timeout={FADE_TIMEOUT}>\n        <div className={classes.zoomContainer}>\n          <ButtonGroup\n            orientation=\"vertical\"\n            variant=\"text\"\n            className={classNames(\n              classes.buttonGroup,\n              classes.buttonGroupVertical\n            )}\n          >\n            <ZoomInControlButton label=\"Zoom In\" map={map} />\n            <ZoomOutControlButton label=\"Zoom Out\" map={map} />\n          </ButtonGroup>\n        </div>\n      </Fade>\n    </Fragment>\n  );\n};\n","import Tile from 'ol/layer/Tile';\nimport { default as OLMap } from 'ol/Map';\nimport OSM from 'ol/source/OSM';\nimport { expandUrl } from 'ol/tileurlfunction';\nimport React, { Component } from 'react';\nimport { Helmet } from 'react-helmet-async';\nimport maps from '../../data/maps/maps.json';\n\nconst urls = maps.map(({ url }) => expandUrl(url)).flat();\n\nexport interface TileLayerProps {\n  map: OLMap;\n  mapUrl: string;\n}\n\nexport class TileLayer extends Component<TileLayerProps> {\n  private xyzSource: OSM;\n  private rasterLayer: Tile;\n  constructor(props: TileLayerProps) {\n    super(props);\n    this.xyzSource = new OSM();\n    this.rasterLayer = new Tile({\n      source: this.xyzSource,\n    });\n    this.rasterLayer.set('id', 'osm-tile-layer');\n  }\n\n  componentDidMount(): void {\n    const { map, mapUrl } = this.props;\n    map.addLayer(this.rasterLayer);\n    this.xyzSource.setUrl(mapUrl);\n  }\n\n  componentDidUpdate(): void {\n    const { mapUrl } = this.props;\n    this.xyzSource.setUrl(mapUrl);\n  }\n\n  componentWillUnmount(): void {\n    const { map } = this.props;\n    map.removeLayer(this.rasterLayer);\n  }\n\n  render(): React.ReactNode {\n    return (\n      <Helmet>\n        {urls.map((url) => (\n          <link key={url} href={new URL(url).origin} rel=\"preconnect\" />\n        ))}\n      </Helmet>\n    );\n  }\n}\n","import { createStyles, makeStyles, Theme } from '@material-ui/core/styles';\n\nexport const useStyles = makeStyles((theme: Theme) =>\n  createStyles({\n    root: {\n      height: '100%',\n    },\n  })\n);\n","import Table from '@material-ui/core/Table';\nimport TableBody from '@material-ui/core/TableBody';\nimport TableCell from '@material-ui/core/TableCell';\nimport TableRow from '@material-ui/core/TableRow';\nimport Feature from 'ol/Feature';\nimport Point from 'ol/geom/Point';\nimport React, { memo } from 'react';\nimport { getDataFromCoords } from '../../util/util';\n\nexport interface PointDataProps {\n  feature: Feature<Point>;\n}\n\nexport const PointData: React.FunctionComponent<PointDataProps> = memo(\n  ({ feature }) => {\n    const { lonLat, hdms, elevation } = getDataFromCoords(\n      feature.getGeometry().getCoordinates()\n    );\n    const lon = (lonLat[0] || 0).toFixed(6);\n    const lat = (lonLat[1] || 0).toFixed(6);\n    return (\n      <Table>\n        <TableBody>\n          <TableRow>\n            <TableCell>Elevation:</TableCell>\n            <TableCell>{elevation}m</TableCell>\n          </TableRow>\n          <TableRow>\n            <TableCell>Longitude:</TableCell>\n            <TableCell>{lon}</TableCell>\n          </TableRow>\n          <TableRow>\n            <TableCell>Latitude:</TableCell>\n            <TableCell>{lat}</TableCell>\n          </TableRow>\n          <TableRow>\n            <TableCell>Coordinates:</TableCell>\n            <TableCell>{hdms}</TableCell>\n          </TableRow>\n        </TableBody>\n      </Table>\n    );\n  }\n);\n","import React, { memo } from 'react';\nimport ArrowForwardIcon from '@material-ui/icons/ArrowForward';\nimport {\n  ControlButton,\n  ControlButtonProps,\n} from '../ControlButton/ControlButton';\n\nexport const NextPointControlButton: React.FunctionComponent<ControlButtonProps> = memo(\n  (props) => (\n    <ControlButton {...props}>\n      <ArrowForwardIcon />\n    </ControlButton>\n  )\n);\n","import React, { memo } from 'react';\nimport ArrowBackIcon from '@material-ui/icons/ArrowBack';\nimport {\n  ControlButton,\n  ControlButtonProps,\n} from '../ControlButton/ControlButton';\n\nexport const PrevPointControlButton: React.FunctionComponent<ControlButtonProps> = memo(\n  (props) => (\n    <ControlButton {...props}>\n      <ArrowBackIcon />\n    </ControlButton>\n  )\n);\n","import { Coordinate } from 'ol/coordinate';\nimport { default as OLMap } from 'ol/Map';\nimport { fromLonLat } from 'ol/proj';\nimport React, { memo } from 'react';\nimport ZoomInIcon from '@material-ui/icons/ZoomIn';\n\nimport {\n  ControlButton,\n  ControlButtonProps,\n} from '../ControlButton/ControlButton';\n\nexport const ANIMATION_DURATION = 800;\n\nexport interface ZoomToPointControlButtonProps {\n  lonLat: Coordinate;\n  map: OLMap;\n}\n\nexport const ZoomToPointControlButton: React.FunctionComponent<\n  ZoomToPointControlButtonProps & Omit<ControlButtonProps, 'onClick'>\n> = memo(({ lonLat, map, ...rest }) => {\n  const onClick = () => {\n    map.getView().animate({\n      center: fromLonLat(lonLat),\n      zoom: 18,\n      duration: ANIMATION_DURATION,\n    });\n  };\n  return (\n    <ControlButton {...rest} onClick={onClick}>\n      <ZoomInIcon />\n    </ControlButton>\n  );\n});\n","function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\nimport * as React from \"react\";\n\nvar _ref2 = /*#__PURE__*/React.createElement(\"path\", {\n  d: \"M12 7C6.48 7 2 9.24 2 12c0 2.24 2.94 4.13 7 4.77V20l4-4-4-4v2.73c-3.15-.56-5-1.9-5-2.73 0-1.06 3.04-3 8-3s8 1.94 8 3c0 .73-1.46 1.89-4 2.53v2.05c3.53-.77 6-2.53 6-4.58 0-2.76-4.48-5-10-5z\"\n});\n\nvar _ref3 = /*#__PURE__*/React.createElement(\"path\", {\n  fill: \"none\",\n  d: \"M0 0h24v24H0z\"\n});\n\nfunction Svg36024Px(_ref, svgRef) {\n  var title = _ref.title,\n      titleId = _ref.titleId,\n      props = _objectWithoutProperties(_ref, [\"title\", \"titleId\"]);\n\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    fill: \"currentColor\",\n    width: \"1.2em\",\n    height: \"1.2em\",\n    viewBox: \"0 0 24 24\",\n    ref: svgRef,\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _ref2, _ref3);\n}\n\nvar ForwardRef = /*#__PURE__*/React.forwardRef(Svg36024Px);\nexport default __webpack_public_path__ + \"static/media/360-24px.9a39ff9e.svg\";\nexport { ForwardRef as ReactComponent };","import Portal from '@material-ui/core/Portal';\nimport { makeStyles } from '@material-ui/core/styles';\nimport React, { Fragment, useState } from 'react';\nimport {\n  ControlButton,\n  ControlButtonProps,\n} from '../ControlButton/ControlButton';\nimport { ReactComponent as Icon360 } from './360-24px.svg';\n\nexport interface Google360ControlButtonProps {\n  pointName: string;\n  embedUrl: string;\n}\n\nconst useStyles = makeStyles({\n  iframe: {\n    width: '100%',\n    position: 'absolute',\n    top: 0,\n    left: 380,\n    right: 0,\n    height: '100%',\n  },\n});\n\nexport const Google360ControlButton: React.FunctionComponent<\n  Google360ControlButtonProps & Omit<ControlButtonProps, 'onClick'>\n> = ({ pointName, embedUrl, ...rest }) => {\n  const classes = useStyles();\n  const [modalOpen, setModalOpen] = useState<boolean>(false);\n\n  const toggle = () => {\n    setModalOpen(!modalOpen);\n  };\n\n  return (\n    <Fragment>\n      <ControlButton {...rest} onClick={toggle}>\n        <Icon360 />\n      </ControlButton>\n      {modalOpen && (\n        <Portal container={document.body}>\n          <iframe\n            title=\"Google Maps 360\"\n            src={embedUrl}\n            frameBorder=\"0\"\n            style={{ border: 0 }}\n            allowFullScreen\n            className={classes.iframe}\n          />\n        </Portal>\n      )}\n      {/* <Modal\n        isOpen={modalOpen}\n        toggle={toggle}\n        centered\n        style={{ maxWidth: '800px' }}\n      >\n        <ModalHeader toggle={toggle}>{pointName} 360</ModalHeader>\n        <ModalBody>\n          <iframe\n            title=\"Google Maps 360\"\n            src={embedUrl}\n            width=\"100%\"\n            height=\"450\"\n            frameBorder=\"0\"\n            style={{ border: 0 }}\n            allowFullScreen\n          />\n        </ModalBody>\n      </Modal> */}\n    </Fragment>\n  );\n};\n","import { createStyles, makeStyles, Theme } from '@material-ui/core/styles';\n\nexport const useStyles = makeStyles((theme: Theme) =>\n  createStyles({\n    root: {\n      // justifyContent: 'space-between',\n      // padding: theme.spacing(0, 3),\n    },\n  })\n);\n","import React from 'react';\nimport { default as OLMap } from 'ol/Map';\nimport Feature from 'ol/Feature';\nimport Point from 'ol/geom/Point';\nimport ButtonGroup from '@material-ui/core/ButtonGroup';\nimport { NextPointControlButton } from '../ControlButtons/NextPointControlButton/NextPointControlButton';\nimport { PrevPointControlButton } from '../ControlButtons/PrevPointControlButton/PrevPointControlButton';\nimport { ZoomToPointControlButton } from '../ControlButtons/ZoomToPointControlButton/ZoomToPointControlButton';\nimport { Google360ControlButton } from '../ControlButtons/Google360ControlButton/Google360ControlButton';\nimport { getDataFromCoords } from '../../util/util';\nimport { useStyles } from './WaypointControlButtons.styles';\n\nexport interface WaypointControlButtonsProps {\n  map: OLMap;\n  feature: Feature<Point>;\n  prevFeature?: Feature<Point>;\n  nextFeature?: Feature<Point>;\n  selectFeature: (feature: Feature<Point>) => void;\n}\n\nexport const WaypointControlButtons: React.FunctionComponent<WaypointControlButtonsProps> = ({\n  map,\n  prevFeature,\n  nextFeature,\n  feature,\n  selectFeature,\n}) => {\n  const classes = useStyles();\n  const { name, google360Url } = feature.getProperties();\n  const { lonLat } = getDataFromCoords(feature.getGeometry().getCoordinates());\n  const onPrevPointButtonClick = () => {\n    if (prevFeature) {\n      selectFeature(prevFeature);\n    }\n  };\n  const onNextPointButtonClick = () => {\n    if (nextFeature) {\n      selectFeature(nextFeature);\n    }\n  };\n  return (\n    <ButtonGroup\n      size=\"large\"\n      variant=\"text\"\n      orientation=\"horizontal\"\n      className={classes.root}\n      fullWidth\n      disableElevation\n    >\n      <ZoomToPointControlButton\n        lonLat={lonLat}\n        map={map}\n        label=\"Zoom to Point\"\n      />\n      <PrevPointControlButton\n        onClick={onPrevPointButtonClick}\n        label=\"Previous Point\"\n        disabled={!prevFeature}\n      />\n      <NextPointControlButton\n        onClick={onNextPointButtonClick}\n        label=\"Next Point\"\n        disabled={!nextFeature}\n      />\n      <Google360ControlButton\n        label=\"View 360\"\n        pointName={name}\n        embedUrl={google360Url}\n        disabled={!google360Url}\n      />\n    </ButtonGroup>\n  );\n};\n","import React, { memo } from 'react';\n\ninterface TabPanelProps {\n  children?: React.ReactNode;\n  index: number;\n  value?: number;\n}\n\nexport const TabPanel: React.FunctionComponent<TabPanelProps> = memo(\n  ({ children, value, index, ...rest }) => {\n    return (\n      <div\n        role=\"tabpanel\"\n        hidden={value !== index}\n        id={`scrollable-auto-tabpanel-${index}`}\n        aria-labelledby={`scrollable-auto-tab-${index}`}\n        {...rest}\n      >\n        {value === index && children}\n      </div>\n    );\n  }\n);\n","import Feature from 'ol/Feature';\nimport Point from 'ol/geom/Point';\nimport VectorLayer from 'ol/layer/Vector';\nimport React, { memo } from 'react';\nimport Table from '@material-ui/core/Table';\nimport TableBody from '@material-ui/core/TableBody';\nimport TableCell from '@material-ui/core/TableCell';\nimport TableRow from '@material-ui/core/TableRow';\nimport { getMultiCoordsFromNextFeature } from '../../util/util';\n\nexport interface NextPointDataProps {\n  gpxVectorLayer: VectorLayer;\n  feature: Feature<Point>;\n  nextFeature: Feature<Point>;\n}\n\nexport const NextPointData: React.FunctionComponent<NextPointDataProps> = memo(\n  ({ feature, nextFeature, gpxVectorLayer }) => {\n    const multiCoords = getMultiCoordsFromNextFeature(\n      feature,\n      nextFeature,\n      gpxVectorLayer\n    );\n    return (\n      <Table>\n        <TableBody>\n          <TableRow>\n            <TableCell>Distance:</TableCell>\n            <TableCell>{multiCoords.distanceInKm}km</TableCell>\n          </TableRow>\n          <TableRow>\n            <TableCell>Elevation gain:</TableCell>\n            <TableCell>{multiCoords.elevationGainUp}m</TableCell>\n          </TableRow>\n          <TableRow>\n            <TableCell>Elevation loss:</TableCell>\n            <TableCell>{multiCoords.elevationGainDown}m</TableCell>\n          </TableRow>\n        </TableBody>\n      </Table>\n    );\n  }\n);\n","import React, { Fragment, memo, useEffect } from 'react';\nimport Tabs from '@material-ui/core/Tabs';\nimport Tab from '@material-ui/core/Tab';\nimport Feature from 'ol/Feature';\nimport Point from 'ol/geom/Point';\nimport VectorLayer from 'ol/layer/Vector';\nimport { TabPanel } from '../TabPanel/TabPanel';\nimport { NextPointData } from '../NextPointData/NextPointData';\n\nexport interface WaypointDrawerTabsProps {\n  feature: Feature<Point>;\n  nextFeature?: Feature<Point>;\n  prevFeature?: Feature<Point>;\n  gpxVectorLayer: VectorLayer;\n}\n\nexport const WaypointDrawerTabs: React.FunctionComponent<WaypointDrawerTabsProps> = memo(\n  ({ feature, nextFeature, prevFeature, gpxVectorLayer }) => {\n    const [value, setValue] = React.useState<number>(\n      nextFeature ? 0 : prevFeature ? 1 : -1\n    );\n    const handleChange = (\n      event: React.ChangeEvent<Record<string, unknown>>,\n      newValue: number\n    ) => {\n      setValue(newValue);\n    };\n    useEffect(() => {\n      setValue(nextFeature ? 0 : prevFeature ? 1 : -1);\n    }, [nextFeature, prevFeature]);\n    return (\n      <Fragment>\n        <Tabs\n          value={value}\n          indicatorColor=\"primary\"\n          textColor=\"primary\"\n          variant=\"fullWidth\"\n          onChange={handleChange}\n        >\n          <Tab label=\"Next Point\" disabled={!nextFeature} />\n          <Tab label=\"Prev Point\" disabled={!prevFeature} />\n        </Tabs>\n        <TabPanel value={value} index={0}>\n          {nextFeature && (\n            <NextPointData\n              gpxVectorLayer={gpxVectorLayer}\n              feature={feature}\n              nextFeature={nextFeature}\n            />\n          )}\n        </TabPanel>\n        <TabPanel value={value} index={1}>\n          {prevFeature && (\n            <NextPointData\n              gpxVectorLayer={gpxVectorLayer}\n              feature={prevFeature}\n              nextFeature={feature}\n            />\n          )}\n        </TabPanel>\n      </Fragment>\n    );\n  }\n);\n","import { createStyles, makeStyles, Theme } from '@material-ui/core/styles';\n\nconst drawerWidth = 380;\n\nexport const useStyles = makeStyles((theme: Theme) =>\n  createStyles({\n    toolbar: {\n      display: 'flex',\n      justifyContent: 'space-between',\n    },\n    drawer: {\n      width: drawerWidth,\n    },\n    drawerPaper: {\n      width: drawerWidth,\n      boxShadow: theme.shadows[24],\n    },\n  })\n);\n","import React from 'react';\nimport { default as OLMap } from 'ol/Map';\nimport Drawer from '@material-ui/core/Drawer';\nimport { useTheme } from '@material-ui/core/styles';\nimport Toolbar from '@material-ui/core/Toolbar';\nimport Typography from '@material-ui/core/Typography';\nimport Divider from '@material-ui/core/Divider';\nimport Box from '@material-ui/core/Box';\nimport Feature from 'ol/Feature';\nimport Point from 'ol/geom/Point';\nimport VectorLayer from 'ol/layer/Vector';\nimport { PointData } from '../PointData/PointData';\nimport { WaypointControlButtons } from '../WaypointControlButtons/WaypointControlButtons';\nimport { WaypointDrawerTabs } from './WaypointDrawerTabs';\n\nimport CloseIcon from '@material-ui/icons/Close';\nimport { useStyles } from './WaypointDrawer.styles';\nimport IconButton from '@material-ui/core/IconButton';\n\nexport interface WaypointDrawerProps {\n  isOpen: boolean;\n  feature: Feature<Point>;\n  nextFeature?: Feature<Point>;\n  prevFeature?: Feature<Point>;\n  map: OLMap;\n  onClose: () => void;\n  selectFeature: (feature: Feature<Point>) => void;\n  gpxVectorLayer: VectorLayer;\n}\n\nexport const WaypointDrawer: React.FunctionComponent<WaypointDrawerProps> = ({\n  isOpen,\n  feature,\n  nextFeature,\n  prevFeature,\n  map,\n  onClose,\n  selectFeature,\n  gpxVectorLayer,\n}) => {\n  const classes = useStyles();\n  const theme = useTheme();\n  const { name } = feature.getProperties();\n\n  const container =\n    window !== undefined ? () => window.document.body : undefined;\n\n  return (\n    <nav className={classes.drawer} aria-label=\"waypoint\">\n      <Drawer\n        container={container}\n        anchor={theme.direction === 'rtl' ? 'right' : 'left'}\n        variant=\"persistent\"\n        open={isOpen}\n        onClose={onClose}\n        classes={{\n          paper: classes.drawerPaper,\n        }}\n        ModalProps={{\n          keepMounted: true, // Better open performance on mobile.\n        }}\n        elevation={16}\n      >\n        <Toolbar className={classes.toolbar}>\n          <Typography variant=\"h6\">{name}</Typography>\n          <IconButton edge=\"end\" onClick={onClose}>\n            <CloseIcon />\n          </IconButton>\n        </Toolbar>\n        <Divider />\n        <WaypointControlButtons\n          feature={feature}\n          nextFeature={nextFeature}\n          prevFeature={prevFeature}\n          map={map}\n          selectFeature={selectFeature}\n        />\n        <Divider />\n\n        <Box mb={2}>\n          <PointData feature={feature} />\n        </Box>\n        <WaypointDrawerTabs\n          feature={feature}\n          nextFeature={nextFeature}\n          prevFeature={prevFeature}\n          gpxVectorLayer={gpxVectorLayer}\n        />\n      </Drawer>\n    </nav>\n  );\n};\n","import { Color } from 'ol/color';\nimport Feature from 'ol/Feature';\nimport Fill from 'ol/style/Fill';\nimport Stroke from 'ol/style/Stroke';\nimport Style from 'ol/style/Style';\nimport Text from 'ol/style/Text';\n\nexport function createPointTextStyle(\n  text: string,\n  color: Color | string\n): Style {\n  return new Style({\n    text: new Text({\n      text,\n      font: 'bold 13px Calibri,sans-serif',\n      overflow: true,\n      offsetY: 10,\n      fill: new Fill({\n        color: color,\n      }),\n      stroke: new Stroke({\n        color: '#000',\n        width: 1,\n      }),\n    }),\n  });\n}\n\nexport function createPointTextFeature(\n  name: string,\n  id: string,\n  color: Color | string\n): Feature {\n  const feature = new Feature({\n    name,\n  });\n  feature.setStyle(createPointTextStyle(name, color));\n  feature.setId(id);\n  return feature;\n}\n","import Point from 'ol/geom/Point';\nimport { Vector as VectorLayer } from 'ol/layer';\nimport { default as OLMap } from 'ol/Map';\nimport STATE from 'ol/source/State';\nimport VectorSource from 'ol/source/Vector';\n\nimport React, { memo, useCallback, useEffect, useMemo } from 'react';\nimport {\n  START_POINT_ID,\n  FINISH_POINT_ID,\n  START_POINT_LABEL,\n  FINISH_POINT_LABEL,\n} from '../../util/constants';\nimport { getMultiLineStringFeature } from '../../util/util';\nimport { createPointTextFeature } from './util';\n\nexport interface StartFinishLayerProps {\n  map: OLMap;\n  gpxVectorLayer: VectorLayer;\n  showMarkers: boolean;\n}\n\nexport const StartFinishLayer: React.FunctionComponent<StartFinishLayerProps> = memo(\n  ({ map, gpxVectorLayer, showMarkers }) => {\n    const startEndVectorLayer = useMemo(() => new VectorLayer(), []);\n    const startEndSource = useMemo(() => new VectorSource(), []);\n\n    const toggleMarkers = useCallback(\n      (show: boolean) => {\n        startEndVectorLayer.setVisible(show);\n      },\n      [startEndVectorLayer]\n    );\n\n    const addFeatures = useCallback(\n      (gpxVectorSource: VectorSource) => {\n        const multiLineStringGeometry = getMultiLineStringFeature(\n          gpxVectorSource.getFeatures()\n        )?.getGeometry();\n        if (!multiLineStringGeometry) {\n          return;\n        }\n        const startFeature = createPointTextFeature(\n          START_POINT_LABEL,\n          START_POINT_ID,\n          '#FFF'\n        );\n        startFeature.setGeometry(\n          new Point(multiLineStringGeometry.getFirstCoordinate())\n        );\n\n        const endFeature = createPointTextFeature(\n          FINISH_POINT_LABEL,\n          FINISH_POINT_ID,\n          '#FFF'\n        );\n        endFeature.setGeometry(\n          new Point(multiLineStringGeometry.getLastCoordinate())\n        );\n\n        startEndSource.addFeatures([startFeature, endFeature]);\n        toggleMarkers(true);\n      },\n      [startEndSource, toggleMarkers]\n    );\n\n    const onGpxVectorLayerStateChange = useCallback(() => {\n      const gpxVectorSource = gpxVectorLayer.getSource();\n      if (\n        gpxVectorSource.getState() === STATE.READY &&\n        gpxVectorSource.getFeatures().length\n      ) {\n        addFeatures(gpxVectorSource);\n      }\n    }, [addFeatures, gpxVectorLayer]);\n\n    useEffect(() => {\n      startEndVectorLayer.setSource(startEndSource);\n    }, [startEndSource, startEndVectorLayer]);\n\n    useEffect(() => {\n      startEndVectorLayer.setZIndex(2);\n      map.addLayer(startEndVectorLayer);\n      return () => {\n        map.removeLayer(startEndVectorLayer);\n      };\n    }, [map, startEndVectorLayer]);\n\n    useEffect(() => {\n      toggleMarkers(false);\n      gpxVectorLayer.once('postrender', onGpxVectorLayerStateChange);\n      return () => gpxVectorLayer.un('postrender', onGpxVectorLayerStateChange);\n    }, [gpxVectorLayer, onGpxVectorLayerStateChange, toggleMarkers]);\n\n    useEffect(() => {\n      toggleMarkers(showMarkers);\n    }, [showMarkers, toggleMarkers]);\n\n    return null;\n  }\n);\n","// import sync from 'ol-hashed';\nimport Feature from 'ol/Feature';\nimport Point from 'ol/geom/Point';\nimport { default as OLMap } from 'ol/Map';\nimport { fromLonLat } from 'ol/proj';\nimport VectorSource from 'ol/source/Vector';\nimport View from 'ol/View';\nimport React, {\n  createRef,\n  Fragment,\n  useCallback,\n  useEffect,\n  useMemo,\n  useState,\n} from 'react';\nimport { useSelector } from 'react-redux';\nimport { RootState } from '../../store';\nimport {\n  getNextFeature,\n  getPrevFeature,\n  getSortedPointFeatures,\n} from '../../util/util';\nimport { GpxLayer } from '../GpxLayer/GpxLayer';\nimport { MapControls } from '../MapControls/MapControls';\nimport { TileLayer } from '../TileLayer/TileLayer';\n// import { Popover } from '../Popover/Popover';\nimport { useStyles } from './styles';\nimport { WaypointDrawer } from '../WaypointDrawer/WaypointDrawer';\nimport { StartFinishLayer } from '../StartFinishLayer/StartFinishLayer';\n\nconst initialState = {\n  lat: 42.184207,\n  lng: 9.1079,\n  zoom: 10,\n};\n\nexport const ANIMATION_DURATION = 250;\n\nexport const Map: React.FunctionComponent = ({ children }) => {\n  const classes = useStyles();\n  const mapRef = createRef<HTMLDivElement>();\n  const [isWaypointDrawerOpen, setIsWaypointDrawerOpen] = useState<boolean>(\n    false\n  );\n\n  const [selectedFeature, setSelectedFeature] = useState<Feature<Point>>();\n  const [sortedPointFeatures, setSortedPointFeatures] = useState<\n    Feature<Point>[]\n  >();\n  const {\n    mapUrl,\n    gpxUrl,\n    showControls,\n    showMarkers,\n    showRoute,\n    showFeatureLabels,\n  } = useSelector((state: RootState) => state.settings);\n\n  const map = useMemo<OLMap>(\n    () =>\n      new OLMap({\n        pixelRatio: 1,\n        controls: [],\n      }),\n    []\n  );\n\n  const nextFeature =\n    selectedFeature &&\n    sortedPointFeatures &&\n    getNextFeature(selectedFeature, sortedPointFeatures);\n\n  const prevFeature =\n    selectedFeature &&\n    sortedPointFeatures &&\n    getPrevFeature(selectedFeature, sortedPointFeatures);\n\n  const onWaypointDrawerClose = () => {\n    setSelectedFeature(undefined);\n    setIsWaypointDrawerOpen(false);\n  };\n\n  const onSelectGpxPointFeature = (feature?: Feature<Point>) => {\n    setSelectedFeature(feature);\n    setIsWaypointDrawerOpen(!!feature);\n  };\n\n  useEffect(() => {\n    const { lat, lng, zoom } = initialState;\n    const target = mapRef.current;\n    if (target) {\n      const view = new View({\n        center: fromLonLat([lng, lat]),\n        zoom,\n      });\n      map.setTarget(target);\n      map.setView(view);\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []);\n\n  const onGpxSourceReady = useCallback((vectorSource: VectorSource) => {\n    const sortedFeatures = getSortedPointFeatures(vectorSource);\n    setSortedPointFeatures(sortedFeatures);\n  }, []);\n\n  // useEffect(() => {\n  //   const coordinates = selectedFeature?.getGeometry().getCoordinates();\n  //   if (coordinates) {\n  //     map.getView().animate({\n  //       center: coordinates,\n  //       duration: ANIMATION_DURATION,\n  //     });\n  //   }\n  // }, [map, selectedFeature]);\n\n  return (\n    <div className={classes.root} ref={mapRef}>\n      <GpxLayer\n        gpxUrl={gpxUrl}\n        showMarkers={showMarkers}\n        showRoute={showRoute}\n        showFeatureLabels={showFeatureLabels}\n        onSourceReady={onGpxSourceReady}\n        map={map}\n        onSelectPointFeature={onSelectGpxPointFeature}\n        selectedFeature={selectedFeature}\n      >\n        {(gpxVectorLayer) => {\n          return (\n            <Fragment>\n              {selectedFeature && (\n                <WaypointDrawer\n                  isOpen={isWaypointDrawerOpen}\n                  feature={selectedFeature}\n                  nextFeature={nextFeature}\n                  prevFeature={prevFeature}\n                  selectFeature={setSelectedFeature}\n                  onClose={onWaypointDrawerClose}\n                  map={map}\n                  gpxVectorLayer={gpxVectorLayer}\n                />\n              )}\n              {showControls && (\n                <MapControls map={map} source={gpxVectorLayer.getSource()} />\n              )}\n              <StartFinishLayer\n                map={map}\n                gpxVectorLayer={gpxVectorLayer}\n                showMarkers={showMarkers}\n              />\n\n              {/* {hoveredFeature && (\n                <Popover\n                  map={map}\n                  feature={hoveredFeature}\n                  isOpen={isPopoverOpen}\n                  setIsOpen={setIsPopoverOpen}\n                />\n              )} */}\n            </Fragment>\n          );\n        }}\n      </GpxLayer>\n      <TileLayer map={map} mapUrl={mapUrl} />\n    </div>\n  );\n};\n","import { createStyles, makeStyles, Theme } from '@material-ui/core/styles';\n\nexport const useStyles = makeStyles((theme: Theme) =>\n  createStyles({\n    content: {\n      position: 'fixed',\n      width: '100%',\n      height: '100%',\n    },\n  })\n);\n","import React, { Fragment } from 'react';\nimport { Helmet } from 'react-helmet-async';\nimport { Map } from '../Map/Map';\nimport { useStyles } from './styles';\n\nexport const MapPage: React.FunctionComponent = () => {\n  const classes = useStyles();\n  return (\n    <Fragment>\n      <Helmet>\n        <title>GR-20 - The Route</title>\n      </Helmet>\n      <main className={classes.content}>\n        <Map />\n      </main>\n    </Fragment>\n  );\n};\n"],"sourceRoot":""}